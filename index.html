<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>일본어 마이크로러닝 (JLPT N1 · 5일)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      min-height: 100vh;
    }
    .app {
      width: 100%;
      max-width: 480px;
      padding: 16px;
    }
    h1 {
      font-size: 1.4rem;
      margin: 0 0 8px;
    }
    .subtitle {
      font-size: 0.85rem;
      color: #9ca3af;
      margin-bottom: 12px;
    }
    .tabs {
      display: flex;
      gap: 4px;
      margin-bottom: 12px;
      background: #020617;
      padding: 4px;
      border-radius: 999px;
    }
    .tab {
      flex: 1;
      padding: 8px;
      text-align: center;
      font-size: 0.85rem;
      cursor: pointer;
      border-radius: 999px;
      border: none;
      background: transparent;
      color: #9ca3af;
    }
    .tab.active {
      background: #38bdf8;
      color: #020617;
      font-weight: 600;
    }
    .card {
      background: #020617;
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 12px;
      box-shadow: 0 10px 25px rgba(15,23,42,0.7);
    }
    .jp-word {
      font-size: 1.6rem;
      margin-bottom: 4px;
    }
    .reading {
      font-size: 0.9rem;
      color: #a5b4fc;
      margin-bottom: 4px;
    }
    .meaning {
      font-size: 1rem;
      color: #fbbf24;
      margin-bottom: 8px;
    }
    .label {
      font-size: 0.75rem;
      color: #9ca3af;
      text-transform: uppercase;
      letter-spacing: .06em;
      margin-top: 8px;
    }
    .sentence-jp {
      font-size: 0.95rem;
      margin-top: 4px;
    }
    .sentence-kr {
      font-size: 0.9rem;
      color: #9ca3af;
      margin-top: 2px;
    }
    .buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 12px;
    }
    .btn {
      flex: 1;
      min-width: 46%;
      padding: 8px 10px;
      font-size: 0.85rem;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: #1d4ed8;
      color: white;
    }
    .btn.secondary {
      background: #111827;
      color: #e5e7eb;
      border: 1px solid #374151;
    }
    .btn.full {
      flex: 1 1 100%;
    }
    .progress {
      font-size: 0.8rem;
      color: #9ca3af;
      margin-bottom: 8px;
    }
    .quiz-options {
      display: grid;
      gap: 8px;
      margin-top: 12px;
    }
    .quiz-option {
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid #374151;
      cursor: pointer;
      font-size: 0.9rem;
      background: #020617;
      color: #e5e7eb; /* 보기 글자색 */
      text-align: left;
    }
    .quiz-option.correct {
      border-color: #22c55e;
      background: #022c22;
    }
    .quiz-option.wrong {
      border-color: #ef4444;
      background: #2b0909;
    }
    .quiz-status {
      font-size: 0.85rem;
      margin-top: 8px;
    }
    .badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      background: #111827;
      font-size: 0.7rem;
      color: #9ca3af;
    }
    .review-list {
      max-height: 60vh;
      overflow-y: auto;
      padding-right: 4px;
    }
    .review-card {
      background: #020617;
      border-radius: 12px;
      padding: 10px 12px;
      margin-bottom: 8px;
      border: 1px solid #111827;
    }
    .small-btn {
      padding: 4px 8px;
      border-radius: 999px;
      border: none;
      font-size: 0.75rem;
      cursor: pointer;
      background: #0ea5e9;
      color: #020617;
    }
    .hint {
      font-size: 0.75rem;
      color: #6b7280;
      margin-top: 4px;
    }
    .reading-title {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 6px;
    }
  </style>
</head>
<body>
<div class="app">
  <h1>일본어 마이크로러닝 (JLPT N1 · 5일)</h1>
  <div class="subtitle">하루 20단어 · 단어 → 문장 퀴즈(빈칸) → 오디오 복습 → 장문 읽기</div>

  <div class="tabs">
    <button class="tab active" data-tab="words">단어 연습</button>
    <button class="tab" data-tab="quiz">문장 퀴즈</button>
    <button class="tab" data-tab="review">오디오 복습</button>
    <button class="tab" data-tab="reading">장문 읽기</button>
  </div>

  <!-- 단어 연습 -->
  <section id="tab-words">
    <div class="progress" id="word-progress"></div>
    <div class="card" id="word-card">
      <div class="jp-word" id="word-jp"></div>
      <div class="reading" id="word-reading"></div>
      <div class="meaning" id="word-meaning"></div>

      <div class="label">예문 (JP)</div>
      <div class="sentence-jp" id="word-sentence-jp"></div>

      <div class="label">해석 (KR)</div>
      <div class="sentence-kr" id="word-sentence-kr"></div>

      <div class="buttons">
        <button class="btn" id="btn-toggle-meaning">뜻/해석 보기</button>
        <button class="btn secondary" id="btn-prev-word">이전</button>
        <button class="btn secondary" id="btn-next-word">다음</button>
        <button class="btn full" id="btn-word-audio">단어+문장 듣기</button>
      </div>
    </div>
    <div class="hint">※ 처음엔 의미를 가리고 일본어만 보고 떠올려 보세요.</div>
  </section>

  <!-- 문장 퀴즈 -->
  <section id="tab-quiz" style="display:none;">
    <div class="progress" id="quiz-progress"></div>
    <div class="card">
      <div class="label">문장</div>
      <div class="sentence-jp" id="quiz-question"></div>
      <div class="sentence-kr" id="quiz-question-kr"></div>

      <div class="label" style="margin-top:12px;">정답 선택</div>
      <div class="quiz-options" id="quiz-options"></div>

      <div class="quiz-status" id="quiz-status"></div>
      <div class="buttons">
        <button class="btn secondary full" id="btn-next-quiz">다음 문제</button>
      </div>
    </div>
    <div class="hint">※ 빈칸에 들어갈 가장 자연스러운 단어를 고르세요.</div>
  </section>

  <!-- 오디오 복습 -->
  <section id="tab-review" style="display:none;">
    <div class="card">
      <div class="label">오늘 학습한 단어 20개</div>
      <div style="margin-top:6px; display:flex; justify-content:space-between; align-items:center;">
        <span class="badge" id="review-badge"></span>
        <button class="small-btn" id="btn-play-all">전체 듣기</button>
      </div>
      <div class="hint">브라우저의 일본어 TTS(음성 합성)를 사용합니다.</div>
    </div>
    <div class="review-list" id="review-list"></div>
  </section>

  <!-- 장문 읽기 -->
  <section id="tab-reading" style="display:none;">
    <div class="card">
      <div class="reading-title" id="reading-title"></div>
      <div class="label">장문 (JP)</div>
      <div class="sentence-jp" id="reading-jp" style="white-space:pre-line;"></div>

      <div class="label">해석 (KR)</div>
      <div class="sentence-kr" id="reading-kr" style="white-space:pre-line;"></div>

      <div class="buttons">
        <button class="btn full" id="btn-reading-audio">장문 전체 듣기</button>
      </div>
    </div>
    <div class="hint">※ JLPT N1 스타일의 장문을 천천히 읽으면서 오늘 단어들이 어떻게 쓰이는지 확인해 보세요.</div>
  </section>
</div>

<script>
  // -------------------------------
  // 1. 5일치 JLPT N1 단어 (각 20개)
  // -------------------------------
  const WEEK_WORDS = [
    // Day 1
    [
      {jp:"把握",reading:"はあく",meaning:"파악하다",sentenceJp:"状況を正確に把握する。",sentenceKr:"상황을 정확하게 파악하다."},
      {jp:"赴く",reading:"おもむく",meaning:"향하다",sentenceJp:"彼は新しい職場へ赴いた。",sentenceKr:"그는 새로운 직장으로 향했다."},
      {jp:"促す",reading:"うながす",meaning:"촉구하다",sentenceJp:"注意を促すアナウンスが流れた。",sentenceKr:"주의를 촉구하는 안내 방송이 흘러나왔다."},
      {jp:"精巧",reading:"せいこう",meaning:"정교하다",sentenceJp:"精巧な時計を修理する。",sentenceKr:"정교한 시계를 수리하다."},
      {jp:"希薄",reading:"きはく",meaning:"희박하다",sentenceJp:"責任感が希薄だと言われた。",sentenceKr:"책임감이 희박하다는 말을 들었다."},
      {jp:"顕著",reading:"けんちょ",meaning:"현저하다",sentenceJp:"売り上げに顕著な変化が見られる。",sentenceKr:"매출에서 현저한 변화가 보인다."},
      {jp:"緩和",reading:"かんわ",meaning:"완화하다",sentenceJp:"渋滞を緩和する対策が必要だ。",sentenceKr:"정체를 완화할 대책이 필요하다."},
      {jp:"拒む",reading:"こばむ",meaning:"거부하다",sentenceJp:"彼はその要求をきっぱり拒んだ。",sentenceKr:"그는 그 요구를 딱 잘라 거부했다."},
      {jp:"阻む",reading:"はばむ",meaning:"막다",sentenceJp:"悪天候が計画の実行を阻んだ。",sentenceKr:"악천후가 계획 실행을 막았다."},
      {jp:"顧みる",reading:"かえりみる",meaning:"돌아보다, 반성하다",sentenceJp:"自分の行動を顧みる時間を持つ。",sentenceKr:"자신의 행동을 돌아보는 시간을 갖다."},
      {jp:"頻繁",reading:"ひんぱん",meaning:"빈번하다",sentenceJp:"最近、地震が頻繁に起きている。",sentenceKr:"최근 지진이 빈번하게 일어나고 있다."},
      {jp:"画期的",reading:"かっきてき",meaning:"획기적이다",sentenceJp:"画期的な技術が開発された。",sentenceKr:"획기적인 기술이 개발되었다."},
      {jp:"如実",reading:"にょじつ",meaning:"여실히",sentenceJp:"数字が結果を如実に示している。",sentenceKr:"숫자가 결과를 여실히 보여주고 있다."},
      {jp:"精密",reading:"せいみつ",meaning:"정밀하다",sentenceJp:"精密検査を受けることになった。",sentenceKr:"정밀 검사를 받게 되었다."},
      {jp:"堅実",reading:"けんじつ",meaning:"견실하다",sentenceJp:"堅実な投資を心がけている。",sentenceKr:"견실한 투자를 하려고 노력하고 있다."},
      {jp:"衰退",reading:"すいたい",meaning:"쇠퇴하다",sentenceJp:"伝統産業が衰退の危機にある。",sentenceKr:"전통 산업이 쇠퇴의 위기에 처해 있다."},
      {jp:"即座",reading:"そくざ",meaning:"즉시",sentenceJp:"彼は即座に返事をした。",sentenceKr:"그는 즉시 대답했다."},
      {jp:"阻止",reading:"そし",meaning:"저지하다",sentenceJp:"暴走を何としても阻止しなければならない。",sentenceKr:"폭주를 어떻게 해서든 저지해야 한다."},
      {jp:"網羅",reading:"もうら",meaning:"망라하다",sentenceJp:"この資料は必要な情報をほぼ網羅している。",sentenceKr:"이 자료는 필요한 정보를 거의 망라하고 있다."},
      {jp:"暗示",reading:"あんじ",meaning:"암시하다",sentenceJp:"彼の態度は変更の可能性を暗示している。",sentenceKr:"그의 태도는 변경 가능성을 암시하고 있다。"}
    ],
    // Day 2
    [
      {jp:"克服",reading:"こくふく",meaning:"극복하다",sentenceJp:"困難を克服して目標を達成した。",sentenceKr:"어려움을 극복하고 목표를 달성했다."},
      {jp:"継承",reading:"けいしょう",meaning:"계승하다",sentenceJp:"文化を次世代に継承する。",sentenceKr:"문화를 다음 세대로 계승한다."},
      {jp:"排除",reading:"はいじょ",meaning:"배제하다",sentenceJp:"危険要因を事前に排除する。",sentenceKr:"위험 요인을 사전에 배제한다."},
      {jp:"露呈",reading:"ろてい",meaning:"노출되다",sentenceJp:"問題点が一気に露呈した。",sentenceKr:"문제점이 한꺼번에 드러났다."},
      {jp:"賠償",reading:"ばいしょう",meaning:"배상하다",sentenceJp:"会社は損害を賠償する責任がある。",sentenceKr:"회사는 손해를 배상할 책임이 있다."},
      {jp:"誇張",reading:"こちょう",meaning:"과장하다",sentenceJp:"彼の話は少し誇張されている。",sentenceKr:"그의 이야기는 조금 과장되어 있다."},
      {jp:"腐敗",reading:"ふはい",meaning:"부패하다",sentenceJp:"政治の腐敗が問題になっている。",sentenceKr:"정치의 부패가 문제가 되고 있다."},
      {jp:"妨げる",reading:"さまたげる",meaning:"방해하다",sentenceJp:"睡眠不足が集中力を妨げる。",sentenceKr:"수면 부족이 집중력을 방해한다."},
      {jp:"陳列",reading:"ちんれつ",meaning:"진열하다",sentenceJp:"新製品を店頭に陳列する。",sentenceKr:"신제품을 매장에 진열한다."},
      {jp:"融通",reading:"ゆうずう",meaning:"융통성",sentenceJp:"彼は融通が利くタイプだ。",sentenceKr:"그는 융통성이 있는 타입이다."},
      {jp:"退治",reading:"たいじ",meaning:"퇴치하다",sentenceJp:"害虫を退治する薬。",sentenceKr:"해충을 퇴치하는 약."},
      {jp:"謙虚",reading:"けんきょ",meaning:"겸손하다",sentenceJp:"彼女는 성공해도 謙虚なままだ。",sentenceKr:"그녀는 성공하고도 여전히 겸손하다."},
      {jp:"寛容",reading:"かんよう",meaning:"관용적이다",sentenceJp:"彼は他人の失敗に寛容だ。",sentenceKr:"그는 타인의 실수에 관용적이다."},
      {jp:"堅固",reading:"けんご",meaning:"견고하다",sentenceJp:"堅固な建物が地震に耐えた。",sentenceKr:"견고한 건물이 지진을 견뎌냈다."},
      {jp:"模索",reading:"もさく",meaning:"모색하다",sentenceJp:"新しい解決策を模索する。",sentenceKr:"새로운 해결책을 모색한다."},
      {jp:"踏襲",reading:"とうしゅう",meaning:"답습하다",sentenceJp:"前例を踏襲するだけでは成長できない。",sentenceKr:"전례를 답습하는 것만으로는 성장할 수 없다."},
      {jp:"蘇生",reading:"そせい",meaning:"소생하다",sentenceJp:"心肺蘇生法を学ぶ。",sentenceKr:"심폐소생법을 배운다."},
      {jp:"阻害",reading:"そがい",meaning:"저해하다",sentenceJp:"過度な規制が発展を阻害している。",sentenceKr:"과도한 규제가 발전을 저해하고 있다."},
      {jp:"考慮",reading:"こうりょ",meaning:"고려하다",sentenceJp:"状況を総合的に考慮して判断する。",sentenceKr:"상황을 종합적으로 고려해 판단한다."},
      {jp:"希求",reading:"ききゅう",meaning:"갈망하다",sentenceJp:"人々は平和を希求している。",sentenceKr:"사람들은 평화를 갈망하고 있다."}
    ],
    // Day 3
    [
      {jp:"陶酔",reading:"とうすい",meaning:"도취하다",sentenceJp:"彼は音楽に陶酔している。",sentenceKr:"그는 음악에 도취해 있다."},
      {jp:"逸脱",reading:"いつだつ",meaning:"일탈하다",sentenceJp:"規範から逸脱した行為だ。",sentenceKr:"규범에서 일탈한 행위다."},
      {jp:"克明",reading:"こくめい",meaning:"세밀하다",sentenceJp:"出来事を克明に記録する。",sentenceKr:"일어났던 일을 세밀히 기록한다."},
      {jp:"懸念",reading:"けねん",meaning:"우려",sentenceJp:"将来の景気悪化が懸念される。",sentenceKr:"향후 경기 악화가 우려된다."},
      {jp:"堪能",reading:"たんのう",meaning:"능숙하다",sentenceJp:"彼女はフランス語に堪能だ。",sentenceKr:"그녀는 프랑스어에 능숙하다."},
      {jp:"精通",reading:"せいつう",meaning:"정통하다",sentenceJp:"彼は法律に精通している。",sentenceKr:"그는 법률에 정통하다."},
      {jp:"顕在化",reading:"けんざいか",meaning:"현실로 드러나다",sentenceJp:"潜在的な問題が顕在化した。",sentenceKr:"잠재돼 있던 문제가 현실로 드러났다."},
      {jp:"陳腐",reading:"ちんぷ",meaning:"진부하다",sentenceJp:"その表現は少し陳腐だ。",sentenceKr:"그 표현은 조금 진부하다."},
      {jp:"緊迫",reading:"きんぱく",meaning:"긴박하다",sentenceJp:"会場には緊迫した空気が流れていた。",sentenceKr:"회장에는 긴박한 공기가 흐르고 있었다."},
      {jp:"腐食",reading:"ふしょく",meaning:"부식하다",sentenceJp:"金属が湿気で腐食した。",sentenceKr:"금속이 습기로 인해 부식되었다."},
      {jp:"錯覚",reading:"さっかく",meaning:"착각",sentenceJp:"時間が早く過ぎたような錯覚に陥る。",sentenceKr:"시간이 빨리 지나간 듯한 착각에 빠진다."},
      {jp:"緩急",reading:"かんきゅう",meaning:"완급",sentenceJp:"話の緩急をつける。",sentenceKr:"이야기의 완급을 조절한다."},
      {jp:"退避",reading:"たいひ",meaning:"퇴피하다",sentenceJp:"避難指示に従って安全な場所へ退避した。",sentenceKr:"대피 지시에 따라 안전한 곳으로 피했다."},
      {jp:"縮小",reading:"しゅくしょう",meaning:"축소하다",sentenceJp:"事業規模を縮小せざるを得ない。",sentenceKr:"사업 규모를 축소하지 않을 수 없다."},
      {jp:"配慮",reading:"はいりょ",meaning:"배려하다",sentenceJp:"周囲への配慮を忘れてはならない。",sentenceKr:"주변에 대한 배려를 잊어서는 안 된다."},
      {jp:"排斥",reading:"はいせき",meaning:"배척하다",sentenceJp:"異なる意見を排斥すべきではない。",sentenceKr:"다른 의견을 배척해서는 안 된다."},
      {jp:"喚起",reading:"かんき",meaning:"환기, 일깨움",sentenceJp:"注意を喚起するポスターを作成した。",sentenceKr:"주의를 환기시키는 포스터를 제작했다."},
      {jp:"改訂",reading:"かいてい",meaning:"개정하다",sentenceJp:"教科書が最新の内容に改訂された。",sentenceKr:"교과서가 최신 내용으로 개정되었다."},
      {jp:"精算",reading:"せいさん",meaning:"정산하다",sentenceJp:"旅費を精算する。",sentenceKr:"여비를 정산한다."},
      {jp:"浸透",reading:"しんとう",meaning:"침투하다, 스며들다",sentenceJp:"新しい価値観가 社会に浸透してきた。",sentenceKr:"새로운 가치관이 사회에 스며들어 왔다."}
    ],
    // Day 4
    [
      {jp:"堕落",reading:"だらく",meaning:"타락하다",sentenceJp:"権力에堕落する。",sentenceKr:"권력에 타락하다."},
      {jp:"妥当",reading:"だとう",meaning:"타당하다",sentenceJp:"その結論は妥当だと思う。",sentenceKr:"그 결론은 타당하다고 생각한다."},
      {jp:"動揺",reading:"どうよう",meaning:"동요하다",sentenceJp:"突然のニュースに心が動揺した。",sentenceKr:"갑작스러운 소식에 마음이 동요했다."},
      {jp:"動員",reading:"どういん",meaning:"동원하다",sentenceJp:"多くの人材を動員してプロジェクトを進める。",sentenceKr:"많은 인재를 동원해 프로젝트를 진행한다."},
      {jp:"難航",reading:"なんこう",meaning:"난항을 겪다",sentenceJp:"交渉は難航している。",sentenceKr:"교섭은 난항을 겪고 있다."},
      {jp:"配属",reading:"はいぞく",meaning:"배치하다",sentenceJp:"新入社員が各部署に配属された。",sentenceKr:"신입사원이 각 부서에 배치되었다."},
      {jp:"破棄",reading:"はき",meaning:"파기하다",sentenceJp:"契約を一方的に破棄した。",sentenceKr:"계약을 일방적으로 파기했다."},
      {jp:"培う",reading:"つちかう",meaning:"기르다, 배양하다",sentenceJp:"経験を通じて能力を培う。",sentenceKr:"경험을 통해 능력을 기른다."},
      {jp:"頻発",reading:"ひんぱつ",meaning:"빈발하다",sentenceJp:"事故が頻発している地域。",sentenceKr:"사고가 빈발하는 지역."},
      {jp:"密接",reading:"みっせつ",meaning:"밀접하다",sentenceJp:"両者の関係は密接だ。",sentenceKr:"양자의 관계는 밀접하다."},
      {jp:"抑制",reading:"よくせい",meaning:"억제하다",sentenceJp:"インフレ를抑制する政策。",sentenceKr:"인플레이션을 억제하는 정책."},
      {jp:"変遷",reading:"へんせん",meaning:"변천하다",sentenceJp:"時代の変遷を振り返る。",sentenceKr:"시대의 변천을 돌아본다."},
      {jp:"錯誤",reading:"さくご",meaning:"착오",sentenceJp:"判断の錯誤が重大な結果を招いた。",sentenceKr:"판단 착오가 중대한 결과를 초래했다."},
      {jp:"是正",reading:"ぜせい",meaning:"시정하다",sentenceJp:"不公平な状況を是正する。",sentenceKr:"불공평한 상황을 시정하다."},
      {jp:"妥結",reading:"だけつ",meaning:"타결되다",sentenceJp:"長い交渉の末、ようやく妥結した。",sentenceKr:"긴 협상 끝에 마침내 타결되었다."},
      {jp:"配慮",reading:"はいりょ",meaning:"배려하다",sentenceJp:"環境への配慮が求められている。",sentenceKr:"환경에 대한 배려가 요구되고 있다."},
      {jp:"改訂",reading:"かいてい",meaning:"개정하다",sentenceJp:"社内規定が全面的に改訂された。",sentenceKr:"사내 규정이 전면 개정되었다."},
      {jp:"露呈",reading:"ろてい",meaning:"드러나다",sentenceJp:"管理体制の甘さが露呈した。",sentenceKr:"관리 체계의 허술함이 드러났다."},
      {jp:"動向",reading:"どうこう",meaning:"동향",sentenceJp:"市場動向を常にチェックする。",sentenceKr:"시장 동향을 항상 체크한다."},
      {jp:"抑止",reading:"よくし",meaning:"억지, 억제",sentenceJp:"犯罪抑止のための対策。",sentenceKr:"범죄 억제를 위한 대책."}
    ],
    // Day 5
    [
      {jp:"圧倒",reading:"あっとう",meaning:"압도하다",sentenceJp:"観客は彼の演奏に圧倒された。",sentenceKr:"관객은 그의 연주에 압도되었다."},
      {jp:"一掃",reading:"いっそう",meaning:"일소하다",sentenceJp:"古い制度を一掃する。",sentenceKr:"낡은 제도를 일소한다."},
      {jp:"逸話",reading:"いつわ",meaning:"일화",sentenceJp:"有名な逸話が数多く残っている。",sentenceKr:"유명한 일화가 많이 남아 있다."},
      {jp:"応酬",reading:"おうしゅう",meaning:"응수, 주고받음",sentenceJp:"激しい議論の応酬が続いた。",sentenceKr:"격렬한 논쟁의 공방이 이어졌다."},
      {jp:"横行",reading:"おうこう",meaning:"횡행하다",sentenceJp:"詐欺が横行している。",sentenceKr:"사기가 횡행하고 있다."},
      {jp:"回避",reading:"かいひ",meaning:"회피하다",sentenceJp:"責任を回避しようとしている。",sentenceKr:"책임을 회피하려 하고 있다."},
      {jp:"介入",reading:"かいにゅう",meaning:"개입하다",sentenceJp:"市場への過度な介入は避けるべきだ。",sentenceKr:"시장에 대한 과도한 개입은 피해야 한다."},
      {jp:"顧慮",reading:"こりょ",meaning:"고려하다",sentenceJp:"相手の立場を顧慮して発言する。",sentenceKr:"상대의 입장을 고려해 발언한다."},
      {jp:"合致",reading:"がっち",meaning:"합치하다",sentenceJp:"双方の意見が合致した。",sentenceKr:"쌍방의 의견이 일치했다."},
      {jp:"示唆",reading:"しさ",meaning:"시사하다",sentenceJp:"研究結果は新しい可能性を示唆している。",sentenceKr:"연구 결과는 새로운 가능성을 시사하고 있다."},
      {jp:"謝絶",reading:"しゃぜつ",meaning:"사절하다",sentenceJp:"取材を丁重に謝絶した。",sentenceKr:"취재를 정중히 사절했다."},
      {jp:"侵害",reading:"しんがい",meaning:"침해하다",sentenceJp:"権利を侵害する行為。",sentenceKr:"권리를 침해하는 행위."},
      {jp:"振興",reading:"しんこう",meaning:"진흥하다",sentenceJp:"地域産業を振興する。",sentenceKr:"지역 산업을 진흥한다."},
      {jp:"推奨",reading:"すいしょう",meaning:"권장하다",sentenceJp:"専門家がこの方法を推奨している。",sentenceKr:"전문가가 이 방법을 권장하고 있다."},
      {jp:"是認",reading:"ぜにん",meaning:"시인하다, 인정하다",sentenceJp:"その行為を是認するわけにはいかない。",sentenceKr:"그 행동을 인정할 수는 없다."},
      {jp:"遷移",reading:"せんい",meaning:"천이, 변이",sentenceJp:"状態が安定から不安定へ遷移した。",sentenceKr:"상태가 안정에서 불안정으로 변했다."},
      {jp:"阻む",reading:"はばむ",meaning:"막다",sentenceJp:"雨が移動を阻んだ。",sentenceKr:"비가 이동을 막았다."},
      {jp:"補填",reading:"ほてん",meaning:"보충, 보전하다",sentenceJp:"不足分を補填する。",sentenceKr:"부족분을 보충한다."},
      {jp:"傍観",reading:"ぼうかん",meaning:"방관하다",sentenceJp:"問題を傍観しているだけではいけない。",sentenceKr:"문제를 방관만 해서는 안 된다."},
      {jp:"露骨",reading:"ろこつ",meaning:"노골적이다",sentenceJp:"露骨な批判を受けた。",sentenceKr:"노골적인 비판을 받았다."}
    ]
  ];

  const WORDS_PER_DAY = 20;
  const TOTAL_DAYS = WEEK_WORDS.length; // 5
  const flatAllWords = WEEK_WORDS.flat();

  // -------------------------------
  // 1-1. 5일치 장문 데이터
  // -------------------------------
  const WEEK_PASSAGES = [
    {
      title: "1일차 장문 – 프로젝트의 문제점 파악",
      jp: `ある会社では、業績の低下の原因を正確に把握するために、プロジェクトチームが結成された。チームは過去数年分のデータを精密に分析し、売り上げの変化を如実に示すグラフを作成した。その結果、顕著な問題点として、現場と本社の連携不足が進行を阻んでいることが分かった。そこで、社員の負担を緩和する新しい報告システムが導入され、担当者は週に一度、自分の行動を顧みるミーティングに参加することになった。こうした取り組みが即座に効果を上げたわけではないが、頻繁に意見交換が行われるようになり、少しずつ職場の雰囲気が変化しつつある。`,
      kr: `어느 회사에서는 실적 하락의 원인을 정확히 파악하기 위해 프로젝트 팀이 결성되었다. 팀은 지난 몇 년간의 데이터를 정밀하게 분석하고, 매출 변화를 여실히 보여 주는 그래프를 만들었다. 그 결과, 현장과 본사의 연계 부족이 진행을 막고 있는 것이 현저한 문제로 드러났다. 이에 따라 직원들의 부담을 완화하기 위한 새로운 보고 시스템이 도입되었고, 담당자들은 주 1회 자신의 행동을 돌아보는 회의에 참여하게 되었다. 이러한 시도가 바로 효과를 낳은 것은 아니지만, 의견 교환이 빈번하게 이루어지면서 서서히 직장의 분위기가 달라지고 있다.`
    },
    {
      title: "2일차 장문 – 지방 도시의 부패와 개혁",
      jp: `ある地方都市では、長年にわたって続いてきた政治の腐敗が問題となっている。公共事業の入札に特定の企業が優先的に選ばれてきたことが、最近の調査で露呈したのだ。市民の怒りは大きく、行政は信頼を回復するために、第三者機関を設置して問題の原因を克服しようとしている。一方で、急激な制度の変更は現場の混乱を招きかねないため、関係者の意見を十分に考慮しながら、段階的な改革案を模索している。若い職員の中には、過去の慣習を踏襲するのではなく、透明性の高い仕組みを築きたいと希求する人も多い。こうした動きが、本当に地域社会の信頼回復につながるのか、今後の取り組みが注目されている。`,
      kr: `어느 지방 도시에서는 오랫동안 이어져 온 정치적 부패가 문제로 떠오르고 있다. 공공 사업 입찰에서 특정 기업이 우선적으로 선정되어 왔다는 사실이 최근 조사에서 드러난 것이다. 시민들의 분노가 커지자 행정 측은 신뢰를 회복하기 위해 제3의 기관을 설치해 문제의 원인을 극복하려 하고 있다. 그러나 급격한 제도 변경은 현장의 혼란을 초래할 수 있기 때문에, 관계자들의 의견을 충분히 고려하면서 단계적인 개혁안을 모색 중이다. 젊은 공무원들 가운데에는 과거의 관행을 답습하지 않고 투명성이 높은 구조를 만들고 싶다고 갈망하는 사람도 많다. 이러한 움직임이 실제로 지역 사회의 신뢰 회복으로 이어질 수 있을지, 앞으로의 노력이 주목받고 있다.`
    },
    {
      title: "3일차 장문 – 연구 프로젝트와 위험 관리",
      jp: `新しい医療機器の開発プロジェクトでは、研究チームが膨大なデータを克明に記録しながら作業を進めている。しかし、計画が順調に進んでいるように見えても、専門家の間では将来のリスクについて懸念する声が上がっている。特に、想定外の不具合が顕在化した場合に、どのように患者の安全を守るかという点が重要だ。そこで、チームは緊迫した雰囲気の中で何度もシミュレーションを行い、万が一の時に備えた退避手順を整備した。こうした配慮があるからこそ、開発段階で発生した小さな錯覚や誤差を早期に修正でき、最終的な製品の信頼性を高めることができると考えられている。`,
      kr: `새로운 의료 기기 개발 프로젝트에서 연구팀은 방대한 데이터를 세밀하게 기록하면서 작업을 진행하고 있다. 겉으로 보기에는 계획이 순조롭게 진행되는 것 같지만, 전문가들 사이에서는 미래의 위험에 대한 우려의 목소리가 나오고 있다. 특히 예기치 못한 고장이 현실로 드러났을 때 어떻게 환자의 안전을 지킬 것인가가 중요하다. 이에 팀은 긴박한 분위기 속에서 여러 차례 시뮬레이션을 실시하고, 만일의 사태에 대비한 대피 절차를 정비했다. 이러한 배려가 있기 때문에 개발 단계에서 발생하는 작은 착오나 오차를 일찍 수정할 수 있고, 최종 제품의 신뢰성을 높일 수 있다고 여겨진다.`
    },
    {
      title: "4일차 장문 – 조직 개편과 직원들의 불안",
      jp: `大手企業で大規模な組織改編が発表され、多くの社員が新しい部署に配属されることになった。経営陣は時代の変遷に対応するためには、これまでの体制を是正し、事業構造を縮小・再編する必要があると説明している。しかし、突然の発表に社員の間では動揺が広がり、一部では自分の将来に対する不安から会社への信頼が衰退しかねないとの声も聞かれる。労働組合は交渉が難航しないよう、会社側に十分な説明と配慮を求めている。最終的には、双方が妥当な条件で妥結し、環境への配慮や働き方改革を盛り込んだ新しい制度に改訂されることが期待されている。`,
      kr: `대기업에서 대규모 조직 개편이 발표되면서 많은 직원이 새로운 부서로 배치되게 되었다. 경영진은 시대의 변천에 대응하려면 기존 체제를 시정하고, 사업 구조를 축소·재편할 필요가 있다고 설명한다. 그러나 갑작스러운 발표에 직원들 사이에서는 동요가 확산되고, 일부에서는 자신의 미래에 대한 불안 때문에 회사에 대한 신뢰가 약화될 수 있다는 목소리도 나온다. 노동조합은 협상이 난항을 겪지 않도록 회사 측에 충분한 설명과 배려를 요구하고 있다. 궁극적으로는 양측이 타당한 조건으로 타결해, 환경에 대한 배려와 일하는 방식의 개선을 담은 새로운 제도로 개정되기를 기대하고 있다.`
    },
    {
      title: "5일차 장문 – 지역 사회와 기업의 역할",
      jp: `地方都市の商店街では、人口減少とネット通販의普及によって来客数が減少し、活気를失いつつある。行政は地域産業の振興を図るため、地元企業と連携して新しいイベントを企画した。企業側は、自社の利益だけを是認するのではなく、地域全体の発展に寄与することが長期的には自分たちの利益にも合致すると考えている。しかし、短期的なコスト負担を理由に協力を回避しようとする企業もあり、意見の応酬が続いている。最終的には、多くの企業が住民の生活を顧慮し、詐欺まがいの販売が横行しないように配慮した上で、共同プロジェクトに参加することになった。小さな一歩かもしれないが、こうした取り組みが地域社会の信頼回復につながると期待されている。`,
      kr: `지방 도시의 상점가는 인구 감소와 인터넷 쇼핑의 보급으로 방문객이 줄어 활기를 잃어 가고 있다. 행정은 지역 산업을 진흥하기 위해 지역 기업과 연계하여 새로운 이벤트를 기획했다. 기업들은 자사 이익만을 인정하는 것이 아니라, 지역 전체의 발전에 기여하는 것이 장기적으로는 자신들의 이익과도 일치한다고 보고 있다. 그러나 단기적인 비용 부담을 이유로 협력을 회피하려는 기업도 있어 의견 공방이 이어지고 있다. 결국 많은 기업이 주민들의 생활을 고려하고, 사기성 판매가 횡행하지 않도록 신경 쓰면서 공동 프로젝트에 참여하기로 했다. 작은 한 걸음일 수 있지만, 이러한 시도가 지역 사회의 신뢰 회복으로 이어지기를 기대하고 있다.`
    }
  ];

  // -------------------------------
  // 2. 오늘이 몇 일차인지 계산 (0~4)
  // -------------------------------
  function getDayIndex() {
    const todayKey = new Date().toISOString().slice(0,10);
    const lastDate = localStorage.getItem("jp_last_date");
    let idx = parseInt(localStorage.getItem("jp_day_index") || "0", 10);

    if (lastDate !== todayKey) {
      idx = (idx + 1) % TOTAL_DAYS;
      localStorage.setItem("jp_day_index", String(idx));
      localStorage.setItem("jp_last_date", todayKey);
    }
    return idx;
  }

  const DAY_INDEX = getDayIndex();
  const todayWords = WEEK_WORDS[DAY_INDEX].slice(0, WORDS_PER_DAY);

  // -------------------------------
  // 탭 전환
  // -------------------------------
  const tabs = document.querySelectorAll(".tab");
  tabs.forEach(tab => {
    tab.addEventListener("click", () => {
      tabs.forEach(t => t.classList.remove("active"));
      tab.classList.add("active");
      const target = tab.dataset.tab;
      document.querySelectorAll("section[id^='tab-']").forEach(sec => {
        sec.style.display = sec.id === "tab-" + target ? "block" : "none";
      });
    });
  });

  // -------------------------------
  // 3. 단어 연습
  // -------------------------------
  let wordIndex = 0;
  let meaningVisible = false;

  const elWordProgress = document.getElementById("word-progress");
  const elWordJp = document.getElementById("word-jp");
  const elWordReading = document.getElementById("word-reading");
  const elWordMeaning = document.getElementById("word-meaning");
  const elWordSentenceJp = document.getElementById("word-sentence-jp");
  const elWordSentenceKr = document.getElementById("word-sentence-kr");

  function renderWord() {
    const w = todayWords[wordIndex];
    elWordProgress.textContent = `오늘의 단어 ${wordIndex + 1} / ${WORDS_PER_DAY} · Day ${DAY_INDEX + 1}`;
    elWordJp.textContent = w.jp;
    elWordReading.textContent = w.reading;
    elWordSentenceJp.textContent = w.sentenceJp;
    elWordSentenceKr.textContent = w.sentenceKr;
    elWordMeaning.textContent = meaningVisible ? w.meaning : "※ 클릭해서 뜻 보기";
  }

  document.getElementById("btn-toggle-meaning").addEventListener("click", () => {
    meaningVisible = !meaningVisible;
    renderWord();
  });

  document.getElementById("btn-next-word").addEventListener("click", () => {
    wordIndex = (wordIndex + 1) % WORDS_PER_DAY;
    meaningVisible = false;
    renderWord();
  });

  document.getElementById("btn-prev-word").addEventListener("click", () => {
    wordIndex = (wordIndex - 1 + WORDS_PER_DAY) % WORDS_PER_DAY;
    meaningVisible = false;
    renderWord();
  });

  document.getElementById("btn-word-audio").addEventListener("click", () => {
    const w = todayWords[wordIndex];
    speakJa(`${w.jp}。${w.sentenceJp}`);
  });

  // -------------------------------
  // 4. 문장 퀴즈 (빈칸 + 4지선다)
  // -------------------------------
  function shuffle(arr) {
    const a = arr.slice();
    for (let i = a.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
  }

  const quizItems = todayWords.map(w => {
    const blankSentence = w.sentenceJp.includes(w.jp)
      ? w.sentenceJp.replace(w.jp, "＿＿")
      : `＿＿：${w.sentenceJp}`;

    let distractors = flatAllWords.filter(x => x.jp !== w.jp);
    if (distractors.length < 3) {
      distractors = distractors.concat([{jp:"例示"}, {jp:"仮説"}, {jp:"補足"}]);
    }
    const others = shuffle(distractors).slice(0,3).map(x => x.jp);
    const options = shuffle([w.jp, ...others]);
    const correctIndex = options.indexOf(w.jp);

    return {
      word: w,
      questionJp: blankSentence,
      questionKr: w.sentenceKr,
      options,
      correctIndex
    };
  });

  let quizIndex = 0;
  let quizScore = 0;
  const elQuizProgress = document.getElementById("quiz-progress");
  const elQuizQuestion = document.getElementById("quiz-question");
  const elQuizQuestionKr = document.getElementById("quiz-question-kr");
  const elQuizOptions = document.getElementById("quiz-options");
  const elQuizStatus = document.getElementById("quiz-status");
  const elBtnNextQuiz = document.getElementById("btn-next-quiz");

  function renderQuiz() {
    const item = quizItems[quizIndex];
    elQuizProgress.textContent = `문제 ${quizIndex + 1} / ${quizItems.length} · 정답 ${quizScore}개`;
    elQuizQuestion.textContent = item.questionJp;
    elQuizQuestionKr.textContent = item.questionKr;
    elQuizOptions.innerHTML = "";
    elQuizStatus.textContent = "";

    item.options.forEach((opt, idx) => {
      const btn = document.createElement("button");
      btn.className = "quiz-option";
      btn.textContent = opt;
      btn.addEventListener("click", () => {
        const isCorrect = idx === item.correctIndex;
        if (isCorrect) {
          quizScore++;
          btn.classList.add("correct");
          elQuizStatus.textContent = "정답!";
        } else {
          btn.classList.add("wrong");
          elQuizStatus.textContent = `오답. 정답: ${item.word.jp}`;
        }
        Array.from(elQuizOptions.children).forEach(b => b.disabled = true);
      });
      elQuizOptions.appendChild(btn);
    });
  }

  elBtnNextQuiz.addEventListener("click", () => {
    quizIndex++;
    if (quizIndex >= quizItems.length) {
      elQuizStatus.textContent = `퀴즈 완료! 총 ${quizScore} / ${quizItems.length} 문제 정답. 다시 처음부터 시작합니다.`;
      quizIndex = 0;
      quizScore = 0;
    }
    renderQuiz();
  });

  // -------------------------------
  // 5. 오디오 복습 리스트
  // -------------------------------
  const elReviewList = document.getElementById("review-list");
  const elReviewBadge = document.getElementById("review-badge");
  elReviewBadge.textContent = `Day ${DAY_INDEX + 1} · 오늘 분량 ${todayWords.length}개`;

  todayWords.forEach((w, idx) => {
    const div = document.createElement("div");
    div.className = "review-card";
    div.innerHTML = `
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:4px;">
        <div>
          <div style="font-size:1.1rem;">${w.jp}</div>
          <div style="font-size:0.8rem; color:#a5b4fc;">${w.reading} · ${w.meaning}</div>
        </div>
        <button class="small-btn" data-idx="${idx}">듣기</button>
      </div>
      <div class="sentence-jp">${w.sentenceJp}</div>
      <div class="sentence-kr">${w.sentenceKr}</div>
    `;
    elReviewList.appendChild(div);
  });

  elReviewList.addEventListener("click", (e) => {
    if (e.target.matches("button.small-btn")) {
      const idx = parseInt(e.target.dataset.idx, 10);
      const w = todayWords[idx];
      speakJa(`${w.jp}。${w.sentenceJp}`);
    }
  });

  document.getElementById("btn-play-all").addEventListener("click", () => {
    let i = 0;
    function playNext() {
      if (i >= todayWords.length) return;
      const w = todayWords[i];
      const utt = new SpeechSynthesisUtterance(`${w.jp}。${w.sentenceJp}`);
      utt.lang = "ja-JP";
      utt.onend = () => { i++; playNext(); };
      window.speechSynthesis.speak(utt);
    }
    playNext();
  });

  // -------------------------------
  // 6. 장문 읽기
  // -------------------------------
  const todayPassage = WEEK_PASSAGES[DAY_INDEX] || WEEK_PASSAGES[0];
  document.getElementById("reading-title").textContent = todayPassage.title;
  document.getElementById("reading-jp").textContent = todayPassage.jp;
  document.getElementById("reading-kr").textContent = todayPassage.kr;

  document.getElementById("btn-reading-audio").addEventListener("click", () => {
    speakJa(todayPassage.jp);
  });

  // -------------------------------
  // 7. 일본어 TTS helper
  // -------------------------------
  function speakJa(text) {
    if (!("speechSynthesis" in window)) {
      alert("이 브라우저는 음성 합성을 지원하지 않습니다.");
      return;
    }
    const utt = new SpeechSynthesisUtterance(text);
    utt.lang = "ja-JP";
    window.speechSynthesis.speak(utt);
  }

  // 초기 렌더링
  renderWord();
  renderQuiz();
</script>
</body>
</html>
